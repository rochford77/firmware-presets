#$ TITLE:  FPVCycle Toothpick 3 3s
#$ FIRMWARE_VERSION: 4.3
#$ CATEGORY: TUNE
#$ STATUS: COMMUNITY
#$ KEYWORDS: FPVCycle TP3, Toothpick, 3s
#$ AUTHOR: mouseFPV
#$ PARSER: MARKED
#$ DESCRIPTION: <br>
#$ DESCRIPTION: <img src="https://user-images.githubusercontent.com/19867640/174462482-28bdcfec-1c3a-43db-99d7-50688b92f050.svg" width="100px" style="margin-left: auto; margin-right: auto; display: block;"/>
#$ DESCRIPTION:
#$ DESCRIPTION: Tune for FPVCycle Toothpick 3 with 13mm 5000kv motors on 3s
#$ DESCRIPTION: ----------
#$ DESCRIPTION: 
#$ DESCRIPTION: About:
#$ DESCRIPTION: ----------
#$ DESCRIPTION: * These gains will be high if your filtering is inadequate. Frame is noisey below 150hz
#$ DESCRIPTION: * My filters are strongly encouraged make sure dynamic notch goes as low as 100hz
#$ DESCRIPTION: * FOR SIDE MOUNT LIPOS ONLY, Experimental option for front-back lipos
#$ DESCRIPTION: * Lipo Orientation very important
#$ DESCRIPTION: * Recommended 48k PWM
#$ DESCRIPTION: 
#$ DESCRIPTION: Options:
#$ DESCRIPTION: ----------
#$ DESCRIPTION: * **Dynamic Idle:** Enables Dynamic Idle for Freestyle 3"
#$ DESCRIPTION: * **Enable Battery Sag Compensation:** Self Explanatory (see tooltip). Land at 3.5v/Cell or it's a bad time.
#$ DESCRIPTION: * **Front-Back Lipo:** The TP3 frame has a side mount lipo. Try this if you choose to mount the lipo front to back. Experimental.
#$ DESCRIPTION: * **Filters -> Include RPM Filter:** Enables bi-directional dshot, sets motor poles to 12, and applies approproiate filter settings. (F4 should use 4k PID loop and DShot300)
#$ DESCRIPTION:
#$ DESCRIPTION: Build Specs This Was Created on:
#$ DESCRIPTION: ----------
#$ DESCRIPTION: * **Frame:** FPVCycle TP3
#$ DESCRIPTION: * **Motors:** FPVCycle 13mm 5000kv 3s, no motor limit
#$ DESCRIPTION: * **FC/ESC:** Flywoo GOKU GNF411 40a
#$ DESCRIPTION: * **AUW:** 103g
#$ DESCRIPTION: 
#$ WARNING: Dynamic Idle Requires DShot telemetry!
#$ DISCLAIMER: Flash At Your Own risk
#$ INCLUDE: presets/4.3/tune/defaults.txt
#$ FORCE_OPTIONS_REVIEW: TRUE
#$ PRIORITY: 1

# -- End Defaults --
# -- Begin Mouse Tune --


# -- PID Sliders  --
set simplified_pids_mode = RPY
set simplified_d_gain = 130
set simplified_pi_gain = 100
set simplified_feedforward_gain = 70
set simplified_dmax_gain = 000
set simplified_i_gain = 80
set simplified_pitch_d_gain = 75
set simplified_pitch_pi_gain = 80
set simplified_master_multiplier = 135
simplified_tuning apply


# -- iTerm relax --
set iterm_relax = RP
set iterm_relax_type = SETPOINT
set iterm_relax_cutoff = 10

# -- TPA  --
set tpa_rate = 70


# -- Feedforward --
set feedforward_boost = 10

# -- Feedforward jitter reduction --
set feedforward_jitter_factor = 14

# -- Antigravity --
set anti_gravity_gain = 3500


# -- Thrust linear (off, default) --
set thrust_linear = 20

# -- VBat warning threshold (3.5V, default)--
set vbat_warning_cell_voltage = 340

# -- DShot Idle (default)--
# Commonly set lower when dynamic idle is active.
set dshot_idle_value = 400

# -- Dyn Idle (off, default) --
set dyn_idle_min_rpm = 0


# -- battery profile --
set auto_profile_cell_count = 3


# ------ OPTIONS GO BELOW THIS LINE ------


# This is where the author includes options that require input from the User

#$ OPTION BEGIN (CHECKED): Dynamic Idle
set dshot_bidir = ON
set dshot_idle_value = 150
set dyn_idle_min_rpm = 30
set dyn_idle_p_gain = 50
#$ OPTION END

#$ OPTION BEGIN (UNCHECKED): Enable Battery Sag Compensation?
set vbat_sag_compensation = 100
#$ OPTION END

#$ OPTION BEGIN (UNCHECKED): Front-Back Lipo (experimental, flips pitch/roll gains)
# -- PID Sliders  --
set simplified_pids_mode = RPY
set simplified_d_gain = 130
set simplified_pi_gain = 100
set simplified_feedforward_gain = 70
set simplified_dmax_gain = 000
set simplified_i_gain = 95
set simplified_pitch_d_gain = 105
set simplified_pitch_pi_gain = 115
set simplified_master_multiplier = 115
simplified_tuning apply

#$ OPTION END


#$ OPTION_GROUP BEGIN: Filters (Choose One or None)

#$ OPTION BEGIN (UNCHECKED): Include RPM Filter?
#$ INCLUDE: presets/4.3/filters/mouseFPV_Clean_RPM_Toothpick.txt
#$ OPTION END


#$ OPTION_GROUP END
