#$ TITLE:  QAV-S | 6s 
#$ FIRMWARE_VERSION: 4.3
#$ CATEGORY: TUNE
#$ STATUS: COMMUNITY
#$ KEYWORDS: tune, pid, FPVCycle, session
#$ AUTHOR: Ryan Rochford (mouseFPV) (Rochford77)
#$ DESCRIPTION: Tune for QAV-S on 6s
#$ DESCRIPTION: Use with 5" Clean Build RPM Filter
#$ DESCRIPTION: Works best with my Smooth Freestyle RC Smoothing 
#$ DESCRIPTION: Works best with my Rates
#$ DESCRIPTION: WARNING: Overwrites all settings mentioned below to defaults.  The User cannot retain their previous values.
#$ DESCRIPTION: DOES NOT reset rates, filters, rc_smoothing, and many other parameters. 
#$ DESCRIPTION: Recommended ESC: 30% Rampup | 23deg Timing | 48k PWM
#$ DESCRIPTION: Default Option for Light action cam
#$ DESCRIPTION: Deselect both camera options if not using action camera
#$ DESCRIPTION: Choose Option for Heavy action cam if using hero 8/9/10
#$ DESCRIPTION: Choose Option for Dynamic Idle For Best Results
#$ DESCRIPTION: Choose Option over 1800kv if over 1800kv on 6s


# THE FOLLOWING PARAMETERS ARE CONTROLLED
# ALL WILL BE RESET TO DEFAULTS WHEN THIS DEFAULT IS RUN
# ALL USER PREFERENCES FOR THESE VALUES WILL BE OVER-WRITTEN
# IF THE AUTHOR WANTS A NON-DEFAULT VALUE, THEIR TUNE MUST SET IT
# BOTH CHECKED AND UNCHECKED OPTIONS CAN BE USED FOR THESE PARAMETERS


# -- PID Sliders  --
set simplified_pids_mode = RP
set simplified_d_gain = 145
set simplified_pi_gain = 110
set simplified_feedforward_gain = 70
set simplified_dmax_gain = 000
set simplified_i_gain = 95
set simplified_pitch_d_gain = 95
set simplified_pitch_pi_gain = 100
set simplified_master_multiplier = 100
simplified_tuning apply

# -- PID values -- --
set p_yaw = 65
set i_yaw = 95
set d_yaw = 0
set d_min_yaw = 0
set f_yaw = 90

# -- iTerm relax --
set iterm_relax = RP
set iterm_relax_type = SETPOINT
set iterm_relax_cutoff = 12

# -- iTerm windup (default) --
set iterm_windup = 85

# -- iTerm rotation (off, default) --
set iterm_rotation = OFF

# -- Dmax (default) --
set d_max_gain = 37
set d_max_advance = 20

# -- TPA  --
set tpa_rate = 70
set tpa_breakpoint = 1350
set tpa_mode = D

# -- Feedforward (default) --
set feedforward_transition = 0
set feedforward_boost = 10
set feedforward_max_rate_limit = 90

# -- Feedforward averaging (do not change)--
# needs to be set according to RC link type and speed, not changed in the tune

# -- Feedforward jitter reduction --
# depends on RC link and flying style - default is 7
set feedforward_jitter_factor = 14


# -- PIDsum limits (default) --
set pidsum_limit = 500
set pidsum_limit_yaw = 400
set iterm_limit = 400

# -- Antigravity (default) --
set anti_gravity_mode = SMOOTH
set anti_gravity_threshold = 250
set anti_gravity_gain = 3500

# -- Absolute control (off, default) --
# this tends to cause iTerm oscillation and is best left off
set abs_control_gain = 0
set abs_control_limit = 90
set abs_control_error_limit = 20
set abs_control_cutoff = 11

# -- Accecleration limits (off, default) --
# these may be configured to prevent I windup on yaw on low authority quads
set acc_limit_yaw = 0
set acc_limit = 0

# -- PIDs active below min throttle (default) --
# always best on
set pid_at_min_throttle = ON

# -- Set mixer type to default (legacy) --
# Will overwrite a user's prefered mixer method
set mixer_type = LEGACY

# -- Set yaw spin recovery to default, which is auto --
# this is the optimal setting for all except radical LOS builds. .
set yaw_spin_recovery = AUTO

# -- Set integrated yaw to off, so pitch and yaw are independent (default) --
# integrated yaw mixes yaw into roll to 'automatically' make coordinated turns
# this will force a user preference for that linkage to be turned off.
# for presets where someone may want this on, provide an option to do that
set use_integrated_yaw = OFF

# -- Gyro cal on first arm (off, default) --
# only calibrates on power up
# faster take-off after first arm when off
set gyro_cal_on_first_arm = OFF

# -- Transient throttle limit (off, default) --
# do not enable if using dynamic idle, replaced with dynamic idle
# best kept off
set transient_throttle_limit = 0

# -- Thrust linear (off, default) --
# increases motor output differentials at low throttle, useful if low thrust at low rpm, commonly used for Whoops
# reset here to ensure a prior whoop flash won't carry thrust linear into other tunes
set thrust_linear = 20

# -- Throttle boost (default, 5)
# adds more throttle when throttle is moved rapidly, to compensate for motor lag
# aggressive builds may need no throttle boost
# Different throttle boost values may be provided to the User with Options
set throttle_boost = 5
set throttle_boost_cutoff = 15

# -- VBat warning threshold (3.5V, default)--
#  Often set lower in whoop builds
set vbat_warning_cell_voltage = 350

# -- DShot Idle (default)--
# Commonly set lower when dynamic idle is active.
set dshot_idle_value = 400

# -- Dyn Idle (off, default) --
# Commonly enabled to improve turns and minimise desyncs
# Since every preset resets this to off, users with desync prone builds will have to re-apply their personal values after this reset
set dyn_idle_min_rpm = 0

# -- VBat sag compensation  --
set vbat_sag_compensation = 100
# set vbat_sag_lpf_period = 2


# ------ OPTIONS GO BELOW THIS LINE ------

# This is where the author includes options that require input from the User

#$ OPTION BEGIN (CHECKED): Dynamic Idle 5"
set dshot_bidir = ON
set dshot_idle_value = 150
set dyn_idle_min_rpm = 20
set dyn_idle_p_gain = 45
#$ OPTION END


#$ OPTION BEGIN (CHECKED): Light Action Cam (Session/Hero7/RC5O/DJI2)
set simplified_master_multiplier = 110
simplified_tuning apply
set iterm_relax_cutoff = 10
set i_yaw = 100
set f_yaw = 96
#$ OPTION END


#$ OPTION BEGIN (UNCHECKED): Heavy Action Cam (Hero8/9/10)
set simplified_master_multiplier = 120
simplified_tuning apply
set i_yaw = 109
set f_yaw = 100
set feedforward_boost = 20
set iterm_relax_cutoff = 8
#$ OPTION END


#$ OPTION BEGIN (UNCHECKED): Over 1800kv 6s
set motor_output_limit = 93
#$ OPTION END





